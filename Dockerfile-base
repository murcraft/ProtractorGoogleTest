FROM node:9.10.1-slim

ENV CHROME_PACKAGE="http://dl.google.com/linux/chrome/deb/pool/main/g/google-chrome-stable/google-chrome-stable_72.0.3626.96-1_amd64.deb"
ENV CHROME_DRIVER=2.46
ENV DBUS_SESSION_BUS_ADDRESS=/dev/null

RUN echo "deb http://http.debian.net/debian stretch-backports main" > /etc/apt/sources.list.d/stretch-backports.list && \
    apt-get update && \
    apt-get install -y -t jessie-backports  openjdk-8-jre-headless ca-certificates-java xvfb bzip2 vim git wget libdbus-glib-1-2 \
    gconf2-common gconf-service libappindicator1 libdbusmenu-gtk4 libgconf-2-4 libgtk2.0-0 libgtk2.0-bin libgtk2.0-common libindicator7 \
    graphicsmagick ghostscript&& \
    wget -q http://mirror.vitalinux.educa.aragon.es/google/pool/main/g/google-chrome-stable/${CHROME_PACKAGE} && \
    dpkg --unpack ${CHROME_PACKAGE} && \
    apt-get install -f -y && \
    apt-get clean && \
    rm ${CHROME_PACKAGE} && \
    rm -rf /tmp/*